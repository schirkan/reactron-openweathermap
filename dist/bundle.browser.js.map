{"version":3,"file":"bundle.browser.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/browser/components/WeatherIcon.tsx","../src/browser/components/WeatherConditionsPerDay.tsx","../src/browser/components/WeatherComponent.tsx","../src/browser/index.ts"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import * as React from 'react';\r\n\r\nlet styleSheetInjected = false;\r\nconst injectStyleSheet = () => {\r\n  if (styleSheetInjected) {\r\n    return;\r\n  }\r\n  styleSheetInjected = true;\r\n  const head = document.head || document.getElementsByTagName('head')[0];\r\n  if (head) {\r\n    const style = document.createElement('link');\r\n    style.rel = 'stylesheet';\r\n    style.href = '/modules/reactron-openweathermap/public/css/weather-icons.min.css';\r\n    head.appendChild(style);\r\n  }\r\n};\r\n\r\ninterface IWeatherIconProps {\r\n  weatherId: string | number;\r\n  night?: boolean;\r\n}\r\n\r\nexport class WeatherIcon extends React.Component<IWeatherIconProps> {\r\n  public componentDidMount() {\r\n    injectStyleSheet();\r\n  }\r\n\r\n  public render() {\r\n    const dayOrNight = this.props.night ? 'night' : 'day';\r\n    const iconClassName = 'wi wi-owm-' + dayOrNight + '-' + this.props.weatherId;\r\n\r\n    return <i className={iconClassName} />;\r\n  }\r\n}\r\n","import moment from 'moment';\r\nimport * as React from 'react';\r\nimport { IWeatherCondition } from 'src/common/interfaces/IWeatherCondition';\r\n\r\nimport './WeatherConditionsPerDay.scss';\r\nimport { WeatherIcon } from './WeatherIcon';\r\n\r\ninterface IWeatherConditionsPerDayProps {\r\n  localDateString: string;\r\n  conditions: IWeatherCondition[];\r\n}\r\n\r\nexport class WeatherConditionsPerDay extends React.Component<IWeatherConditionsPerDayProps> {\r\n  private renderConditions() {\r\n    return (\r\n      <div className=\"condition-list\">\r\n        {this.props.conditions.map(c => {\r\n          const night = c.weather_icon.endsWith('n');\r\n          const rain = Math.round(c.rain * 100) / 100;\r\n          const snow = Math.round(c.snow * 100) / 100;\r\n\r\n          return (\r\n            <React.Fragment key={c.dt}>\r\n              <span>{moment.utc(c.dt_txt).local().format('HH:mm')}</span>\r\n              <span><WeatherIcon weatherId={c.weather_id} night={night} /></span>\r\n              <span>{c.weather_description}</span>\r\n              <span>{c.temp}</span>\r\n              <span>\r\n                {rain ? (<React.Fragment>Rain: {rain.toFixed(2)} mm</React.Fragment>) : null}\r\n                {snow ? (<React.Fragment> - Snow: {snow.toFixed(2)} mm</React.Fragment>) : null}\r\n              </span>\r\n            </React.Fragment>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <section className=\"WeatherConditionsPerDay\" >\r\n        <span className=\"date-header\">{this.props.localDateString}</span>\r\n        {this.renderConditions()}\r\n      </section>\r\n    );\r\n  }\r\n}\r\n","import { IReactronComponentContext } from '@schirkan/reactron-interfaces';\r\nimport moment from 'moment';\r\nimport * as React from 'react';\r\nimport { ILocationRequest } from 'src/common/interfaces/ILocationRequest';\r\nimport { IWeatherCondition } from 'src/common/interfaces/IWeatherCondition';\r\nimport { IWeatherForecast } from 'src/common/interfaces/IWeatherForecast';\r\nimport { IWeatherService } from 'src/common/interfaces/IWeatherService';\r\nimport { WeatherConditionsPerDay } from './WeatherConditionsPerDay';\r\n\r\nimport './WeatherComponent.scss';\r\n\r\ninterface IWeatherComponentState {\r\n  weatherForecast?: IWeatherForecast;\r\n  error?: any;\r\n}\r\n\r\nexport class WeatherComponent extends React.Component<ILocationRequest, IWeatherComponentState> {\r\n  public context: IReactronComponentContext;\r\n\r\n  constructor(props: ILocationRequest) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.loadWeatherData();\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: ILocationRequest) {\r\n    if (JSON.stringify(this.props) !== JSON.stringify(prevProps)) {\r\n      this.loadWeatherData();\r\n    }\r\n  }\r\n\r\n  private loadWeatherData() {\r\n    const weatherService = this.context.getService<IWeatherService>('WeatherService');\r\n    if (weatherService) {\r\n      weatherService.getFiveDaysForecast(this.props)\r\n        .then(response => this.setState({ weatherForecast: response }))\r\n        .catch(error => this.setState({ error }));\r\n    }\r\n  }\r\n\r\n  private renderForecast() {\r\n    if (!this.state.weatherForecast) {\r\n      return;\r\n    }\r\n\r\n    const days: { [date: string]: IWeatherCondition[] } = {};\r\n\r\n    // group by date\r\n    this.state.weatherForecast.list.forEach(item => {\r\n      const localDate = moment.utc(item.dt_txt).local();\r\n      const localDateString = localDate.format('YYYY-MM-DD');\r\n      if (!days[localDateString]) {\r\n        days[localDateString] = [];\r\n      }\r\n      days[localDateString].push(item);\r\n    });\r\n\r\n    return (\r\n      <div>\r\n        {Object.keys(days).map(dateString =>\r\n          <WeatherConditionsPerDay key={dateString} localDateString={dateString} conditions={days[dateString]} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public render() {\r\n    if (this.state.error) {\r\n      return 'Error: ' + this.state.error;\r\n    }\r\n\r\n    if (!this.state.weatherForecast) {\r\n      return this.context.renderLoading('Loading weather...');\r\n    }\r\n\r\n    return (\r\n      <section className=\"WeatherComponent\">\r\n        <h2>\r\n          Weather for {this.state.weatherForecast.city.name}, {this.state.weatherForecast.city.country}\r\n        </h2>\r\n        {this.renderForecast()}\r\n      </section>\r\n    );\r\n  }\r\n}\r\n","import { IReactronComponentDefinition } from '@schirkan/reactron-interfaces';\r\nimport { WeatherComponent } from './components/WeatherComponent';\r\nimport { WeatherIcon } from './components/WeatherIcon';\r\n\r\nexport * from './components/WeatherComponent';\r\n\r\nexport const components: IReactronComponentDefinition[] = [{\r\n    component: WeatherComponent,\r\n    description: 'Weather Forecast by OpenWeatherMap',\r\n    displayName: 'Weather Forecast',\r\n    fields: [{\r\n        description: 'City Name',\r\n        displayName: 'City Name',\r\n        name: 'cityName',\r\n        valueType: 'string'\r\n    }, {\r\n        description: 'Zip, Country Code',\r\n        displayName: 'Zip, Country Code',\r\n        name: 'zip',\r\n        valueType: 'string'\r\n    }, {\r\n        description: 'Coordinates',\r\n        displayName: 'Coordinates',\r\n        name: 'coords',\r\n        valueType: 'object',\r\n        fields: [{\r\n            description: 'lat',\r\n            displayName: 'lat',\r\n            name: 'lat',\r\n            valueType: 'number'\r\n        }, {\r\n            description: 'lon',\r\n            displayName: 'lon',\r\n            name: 'lon',\r\n            valueType: 'number'\r\n        }]\r\n    }, {\r\n        description: 'City Id',\r\n        displayName: 'City Id',\r\n        name: 'cityId',\r\n        valueType: 'number'\r\n    }],\r\n    name: 'WeatherComponent'\r\n}, {\r\n    component: WeatherIcon,\r\n    type: 'internal',\r\n    name: 'WeatherIcon',\r\n    displayName: 'WeatherIcon'\r\n}];"],"names":["tslib_1.__extends","React.createElement","React.Component","React.Fragment"],"mappings":"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"}